# 第7章 权重生成与评价模型

> 评价模型：解决对于一个目标不同方案之间比较或不同影响因素之间比较的问题。

## 7.1 层次分析法

层次分析法是美国运筹学家匹茨堡大学教授萨蒂于20世纪70年代初提出的一种评价策略。这种策略虽然带有*一定主观性*，但非常奏效，也是在社会科学研究中经常使用的一类方法。

层次分析法的流程分五步走：

1. **选择指标**，构建层次模型。
2. 对目标层到准则层之间和准则层到方案层之间构建**比较矩阵**。
3. 对每个比较矩阵计算CR值检验是否通过CR检验，**如果没有通过检验需要调整比较矩阵**。
4. 求出每个矩阵最大的特征值对应的归一化权重向量。
5. 根据不同矩阵的归一化权向量计算出不同方案的得分进行比较。

层次分析的想法简述：层次分析法是依托于比较的方案，一定要有多个方案，才能进行比较。比较不同的方案需要有相应的支点，所以选择指标很重要。类似买东西的适合要通过多个维度（价格，寿命等）考察一个商品的好坏。多个评价指标之间是相互关联的，甚至可以有**上下层级**的指标。

评级指标的权重确认一般采用 Delphi 法进行指标权重的确定。

AHP 的主要思想是：通过分析复杂系统的有关要素及相互关系，把问题简化为多层次的梯阶层次结构，自上而下分别为目标层、准则层和措施层。在该层次结构中,下层元素受上层元素控制，通过两两比较的方法建立判断矩阵，并通过一致性检验步骤检查判断矩阵的合理性，最终确定下层元素对于上层元素的权重。

### 构造判断矩阵

判断矩阵是，根据重要程度将层次结构模型中同一层次的要素相对于上层的某个因素，相互之间成对比较而形成的矩阵。假定 $A$ 层中元素 $A_k$ 与下一层 $n$ 个元素 $A_1,A_2,...,A_n$ 有关联，构造的判断矩阵如下

$$
\mathbf{B}=\begin{pmatrix}b_{11}&\ldots&b_{1n}\\\vdots&\ddots&\vdots\\b_{n1}&\cdots&b_{nn}\end{pmatrix}
$$

- $b_{ij}$ 表示对 $A_k$ 而言，$B_i$ 对 $B_j$ 相对重要性的数值表现。通常使用 1-9 表示法。

|标度| 含义|
|---------|----------|
| 1| 两元素同等重要|
| 3| 前一个元素比后一个元素稍微重要|
| 5| 前一个元素比后一个元素明显重要|
| 7| 前一个元素比后一个元素强烈重要|
| 9| 前一个元素比后一个元素绝对重要|
|2,4,6,8|上述两个标度的中值|

判断矩阵要有如下性质：

- $b_{ij}*b_{ji} = 1$
- $b_{ii}=1$

### 计算 CR 和 权重

首先需要计算**特征向量和特征值**

$CR$ 计算公式

$$
CR=\frac{{CI}}{{RI}}
$$

其中

$$
{CI=\frac{{ \lambda \mathop{{}}\nolimits_{{max}}-n}}{{n-1}}}
$$

| n      | 1    | 2    | 3    | 4    | 5    | 6    | 7    |
| ------ | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| **RI** | 0    | 0    | 0.52 | 0.89 | 1.12 | 1.26 | 1.32 |
| **n**  | 8    | 9    | 10   | 11   | 12   | 13   | 14   |
| **RI** | 1.41 | 1.46 | 1.49 | 1.52 | 1.54 | 1.56 | 1.58 |

权重归一化公式

$$
x_i=\frac{x_i}{\sum_{i-1}^n x_i}
$$

## 7.2 熵权分析法
